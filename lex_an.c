/* Generated by re2c 2.0.3 on Thu May 20 18:47:36 2021 */
#line 1 "lex_an.re"
#include "lex_an.h"

void write_ts(const char * ident, char * label, int line, TS * ts,int value){
	entries_t entrie;
	strcpy(entrie.ident, ident);
	strcpy(entrie.label, label);
	entrie.id=ts->qnt_entries;
	entrie.line = line;
	entrie.value = value;
	ts->entries[ts->qnt_entries++] = entrie;
}

static int lex(const char *YYCURSOR, const int line, TS * ts)
{
//	fprintf(stderr,"%s\n",YYCURSOR);
//	const char *YYMARKER;
	const char * saved = YYCURSOR;
    loop:
		saved = YYCURSOR;
    
#line 24 "lex_an.c"
{
	char yych;
	yych = *YYCURSOR;
	switch (yych) {
	case 0x00:	goto yy2;
	case '!':	goto yy6;
	case '"':	goto yy7;
	case '(':	goto yy9;
	case ')':	goto yy11;
	case '.':	goto yy13;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy15;
	case ';':	goto yy18;
	case '=':	goto yy20;
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'g':
	case 'h':
	case 'j':
	case 'k':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy22;
	case 'e':	goto yy25;
	case 'f':	goto yy26;
	case 'i':	goto yy27;
	case 'l':	goto yy28;
	case 'r':	goto yy29;
	case '{':	goto yy30;
	case '}':	goto yy32;
	default:	goto yy4;
	}
yy2:
	++YYCURSOR;
#line 48 "lex_an.re"
	{ return 0; }
#line 107 "lex_an.c"
yy4:
	++YYCURSOR;
yy5:
#line 70 "lex_an.re"
	{write_ts(saved,"ERR", line, ts,0); return 0;}
#line 113 "lex_an.c"
yy6:
	yych = *++YYCURSOR;
	switch (yych) {
	case '=':	goto yy34;
	default:	goto yy5;
	}
yy7:
	yych = *++YYCURSOR;
	switch (yych) {
	case '"':	goto yy36;
	default:	goto yy7;
	}
yy9:
	++YYCURSOR;
#line 61 "lex_an.re"
	{write_ts(saved,"(", line, ts,0); goto loop;}
#line 130 "lex_an.c"
yy11:
	++YYCURSOR;
#line 62 "lex_an.re"
	{write_ts(saved,")", line, ts,0); goto loop;}
#line 135 "lex_an.c"
yy13:
	++YYCURSOR;
#line 67 "lex_an.re"
	{write_ts(saved,".", line, ts,0); goto loop;}
#line 140 "lex_an.c"
yy15:
	yych = *++YYCURSOR;
	switch (yych) {
	case '.':	goto yy38;
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy15;
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy40;
	default:	goto yy17;
	}
yy17:
#line 56 "lex_an.re"
	{
			write_ts(saved,"NUM", line, ts,atoi(saved));
			goto loop;}
#line 215 "lex_an.c"
yy18:
	++YYCURSOR;
#line 66 "lex_an.re"
	{write_ts(saved,";", line, ts,0); goto loop;}
#line 220 "lex_an.c"
yy20:
	yych = *++YYCURSOR;
	switch (yych) {
	case '=':	goto yy42;
	default:	goto yy21;
	}
yy21:
#line 65 "lex_an.re"
	{write_ts(saved,"=", line, ts,0); goto loop;}
#line 230 "lex_an.c"
yy22:
	yych = *++YYCURSOR;
yy23:
	switch (yych) {
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy22;
	default:	goto yy24;
	}
yy24:
#line 55 "lex_an.re"
	{write_ts(saved,"ID", line, ts,0); goto loop;}
#line 303 "lex_an.c"
yy25:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'l':	goto yy44;
	default:	goto yy23;
	}
yy26:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'u':	goto yy45;
	default:	goto yy23;
	}
yy27:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'f':	goto yy46;
	default:	goto yy23;
	}
yy28:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy48;
	default:	goto yy23;
	}
yy29:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy49;
	default:	goto yy23;
	}
yy30:
	++YYCURSOR;
#line 59 "lex_an.re"
	{write_ts(saved,"{", line, ts,0); goto loop;}
#line 338 "lex_an.c"
yy32:
	++YYCURSOR;
#line 60 "lex_an.re"
	{write_ts(saved,"}", line, ts,0); goto loop;}
#line 343 "lex_an.c"
yy34:
	++YYCURSOR;
#line 64 "lex_an.re"
	{write_ts(saved,"!=", line, ts,0); goto loop;}
#line 348 "lex_an.c"
yy36:
	++YYCURSOR;
#line 68 "lex_an.re"
	{write_ts(saved,"STR", line, ts,0); goto loop;}
#line 353 "lex_an.c"
yy38:
	yych = *++YYCURSOR;
	switch (yych) {
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':	goto yy38;
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy40;
	default:	goto yy17;
	}
yy40:
	++YYCURSOR;
#line 69 "lex_an.re"
	{write_ts(saved,"ERR", line, ts,0); return 0;}
#line 426 "lex_an.c"
yy42:
	++YYCURSOR;
#line 63 "lex_an.re"
	{write_ts(saved,"==", line, ts,0); goto loop;}
#line 431 "lex_an.c"
yy44:
	yych = *++YYCURSOR;
	switch (yych) {
	case 's':	goto yy50;
	default:	goto yy23;
	}
yy45:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy51;
	default:	goto yy23;
	}
yy46:
	yych = *++YYCURSOR;
	switch (yych) {
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy22;
	default:	goto yy47;
	}
yy47:
#line 53 "lex_an.re"
	{write_ts(saved,"IF", line, ts,0); goto loop;}
#line 515 "lex_an.c"
yy48:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy52;
	default:	goto yy23;
	}
yy49:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy53;
	default:	goto yy23;
	}
yy50:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'e':	goto yy54;
	default:	goto yy23;
	}
yy51:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'c':	goto yy56;
	default:	goto yy23;
	}
yy52:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'p':	goto yy57;
	default:	goto yy23;
	}
yy53:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'u':	goto yy59;
	default:	goto yy23;
	}
yy54:
	yych = *++YYCURSOR;
	switch (yych) {
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy22;
	default:	goto yy55;
	}
yy55:
#line 54 "lex_an.re"
	{write_ts(saved,"ELSE", line, ts,0); goto loop;}
#line 623 "lex_an.c"
yy56:
	yych = *++YYCURSOR;
	switch (yych) {
	case 't':	goto yy60;
	default:	goto yy23;
	}
yy57:
	yych = *++YYCURSOR;
	switch (yych) {
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy22;
	default:	goto yy58;
	}
yy58:
#line 52 "lex_an.re"
	{write_ts(saved,"LOOP", line, ts,0); goto loop;}
#line 701 "lex_an.c"
yy59:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'r':	goto yy61;
	default:	goto yy23;
	}
yy60:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'i':	goto yy62;
	default:	goto yy23;
	}
yy61:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy63;
	default:	goto yy23;
	}
yy62:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'o':	goto yy65;
	default:	goto yy23;
	}
yy63:
	yych = *++YYCURSOR;
	switch (yych) {
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy22;
	default:	goto yy64;
	}
yy64:
#line 50 "lex_an.re"
	{write_ts(saved,"RETURN", line, ts,0); goto loop;}
#line 797 "lex_an.c"
yy65:
	yych = *++YYCURSOR;
	switch (yych) {
	case 'n':	goto yy66;
	default:	goto yy23;
	}
yy66:
	yych = *++YYCURSOR;
	switch (yych) {
	case '0':
	case '1':
	case '2':
	case '3':
	case '4':
	case '5':
	case '6':
	case '7':
	case '8':
	case '9':
	case 'A':
	case 'B':
	case 'C':
	case 'D':
	case 'E':
	case 'F':
	case 'G':
	case 'H':
	case 'I':
	case 'J':
	case 'K':
	case 'L':
	case 'M':
	case 'N':
	case 'O':
	case 'P':
	case 'Q':
	case 'R':
	case 'S':
	case 'T':
	case 'U':
	case 'V':
	case 'W':
	case 'X':
	case 'Y':
	case 'Z':
	case '_':
	case 'a':
	case 'b':
	case 'c':
	case 'd':
	case 'e':
	case 'f':
	case 'g':
	case 'h':
	case 'i':
	case 'j':
	case 'k':
	case 'l':
	case 'm':
	case 'n':
	case 'o':
	case 'p':
	case 'q':
	case 'r':
	case 's':
	case 't':
	case 'u':
	case 'v':
	case 'w':
	case 'x':
	case 'y':
	case 'z':	goto yy22;
	default:	goto yy67;
	}
yy67:
#line 51 "lex_an.re"
	{write_ts(saved,"FUNCTION", line, ts,0); goto loop;}
#line 875 "lex_an.c"
}
#line 71 "lex_an.re"


}


void lex_check(char * file, TS * ts){
	FILE * fp = fopen(file,"r");
	FILE * of = fopen("lex.output","w");
//	fseek(fp,0,-1);
//	int size = ftell(fp);
//	fseek(fp,0,0);
	char c;
	int line = 1;
	char word[1000]; int wc = 0;
//	char buffer[1000];
	while (!feof(fp)){
		c = fgetc(fp);
//		putchar(c);
		if(c==' '||c=='\n'||c=='\t'){
			if (c == '\n')
				line ++;
			if (strlen(word) >= 1)
				lex(word,line, ts);
			for (int i = 0; i < wc; i++) word[i]=0;
			wc = 0;
		}else
			word[wc++] = c;
	}
	fclose(fp);
	printf("TS entries: %d\n TABLE:\n",ts->qnt_entries);
	printf("\n\tid\tiden\tlabel\t\tline\t\tvalue\n");
	for (int i=0; i<ts->qnt_entries; i++){
		entries_t entrie = ts->entries[i];
		char * str = entrie.label;
		printf("%d\t%s\t\t%s\t\t%d\t\t%d\n",entrie.id,entrie.ident,str,entrie.line,entrie.value);
		if (strcmp(entrie.label,"ERR")==0)
			fprintf(stderr,"Erro na linha: %d\nIdentificador: %s\n",entrie.line,entrie.ident);
		fwrite(str,sizeof(char),strlen(str),of);
		fputc(' ',of);
	}
	fwrite("$\n",sizeof(char),2,of);
	fclose(of);
	printf("$\n");

	of = fopen("TS.out","w");
	fwrite(&(ts->qnt_entries),sizeof(int),1,of);
	fwrite(ts->entries,sizeof(entries_t),ts->qnt_entries,of);
	fclose(of);
/*    for (int i = 1; i < argc; ++i) {
        lex(argv[i]);
    }
	*/


}


int main(int argc, char **argv)
{
	char * file = argv[argc-1];
	TS ts;
	entries_t entries[1000];
	ts.qnt_entries = 0;
	ts.entries = entries;
	lex_check(file,&ts);
    return 0;
}
